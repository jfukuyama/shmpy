mean(fixed_v)
mean(random_v)
mean(random_g)
baseage
(10-baseage)^2
var((10-baseage)^2)
random
hist(random)
mean(random)
# d.
library(nlme)
N <- 2000
fixed <- rep(0,N)
random <- rep(0,N)
fixed_v <- rep(0,N)
random_v <- rep(0,N)
random_g <- rep(0,N)
for(i in 1:N){
# Generate data
subjects <- rep(0,3*91)
for(j in 1:91){
subjects[(3*(j-1)+1):(3*(j-1)+3)] <- j
}
obs <- rep(c(1,2,3),91)
df <- data.frame("subject"= subjects,"obs"=obs)
baseage <- 1+0.1*(df$subject-1)
age <- baseage+obs*(1+((10-baseage)/10))^2
df <- cbind(df,baseage,age)
sigma_2 <- 100
literacy <- (10-df$baseage)^2+(df$age-df$baseage)+rnorm(3*91,mean=0,sd=10)
df <- cbind(df,literacy)
df<- df%>% mutate(followage= age-baseage)
mf <- lm(literacy~-1+followage+as.factor(subject), data = df)
mr <- lme(fixed = literacy ~ followage,
random = reStruct(~1 | subject),data=df)
fixed[i] <- coef(mf)[1]
random[i] <- fixed.effects(mr)[2]
fixed_v[i] <- summary(mf)$sigma^2
random_v[i] <- mr$sigma^2
random_g[i] <- getVarCov(mr)[[1]]
}
mean(fixed)
sd(fixed)
mean(random)
# d.
library(nlme)
N <- 2000
fixed <- rep(0,N)
random <- rep(0,N)
fixed_v <- rep(0,N)
random_v <- rep(0,N)
random_g <- rep(0,N)
for(i in 1:N){
# Generate data
subjects <- rep(0,3*91)
for(j in 1:91){
subjects[(3*(j-1)+1):(3*(j-1)+3)] <- j
}
obs <- rep(c(1,2,3),91)
df <- data.frame("subject"= subjects,"obs"=obs)
baseage <- 1+0.1*(df$subject-1)
age <- baseage+obs*(1+((10-baseage)/10))^2
df <- cbind(df,baseage,age)
sigma_2 <- 100
literacy <- (10-df$baseage)^2+(df$age-df$baseage)+rnorm(3*91,mean=0,sd=10)
df <- cbind(df,literacy)
df<- df%>% mutate(followage= age-baseage)
mf <- lm(literacy~-1+followage+as.factor(subject), data = df)
mr <- lme(fixed = literacy ~ followage,
random = reStruct(~1 | as.factor(subject)),data=df)
fixed[i] <- coef(mf)[1]
random[i] <- fixed.effects(mr)[2]
fixed_v[i] <- summary(mf)$sigma^2
random_v[i] <- mr$sigma^2
random_g[i] <- getVarCov(mr)[[1]]
}
mean(fixed)
sd(fixed)
mean(random)
sd(random)
mean(fixed_v)
mean(random_v)
mean(random_g)
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)
sigma_2
sigm
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
sigm
df
# d.
library(nlme)
N <- 2000
fixed <- rep(0,N)
random <- rep(0,N)
fixed_v <- rep(0,N)
random_v <- rep(0,N)
random_g <- rep(0,N)
for(i in 1:N){
# Generate data
subjects <- rep(0,3*91)
for(j in 1:91){
subjects[(3*(j-1)+1):(3*(j-1)+3)] <- j
}
obs <- rep(c(1,2,3),91)
df <- data.frame("subject"= subjects,"obs"=obs)
baseage <- 1+0.1*(df$subject-1)
age <- baseage+(obs-1)*(1+((10-baseage)/10))^2
df <- cbind(df,baseage,age)
sigma_2 <- 100
literacy <- (10-df$baseage)^2+(df$age-df$baseage)+rnorm(3*91,mean=0,sd=10)
df <- cbind(df,literacy)
df<- df%>% mutate(followage= age-baseage)
mf <- lm(literacy~-1+followage+as.factor(subject), data = df)
mr <- lme(fixed = literacy ~ followage,
random = reStruct(~1 | as.factor(subject)),data=df)
fixed[i] <- coef(mf)[1]
random[i] <- fixed.effects(mr)[2]
fixed_v[i] <- summary(mf)$sigma^2
random_v[i] <- mr$sigma^2
random_g[i] <- getVarCov(mr)[[1]]
}
mean(fixed)
sd(fixed)
mean(random)
sd(random)
mean(fixed_v)
mean(random_v)
mean(random_g)
# Get value of sig_2
var((10-baseage)^2)
calc <- function(df,sigma_2){
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(id == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(id == 1) %>% select(literacy)
xwx <- temp_x %*% w %*% temp_x
xwy <- temp_x %*% w %*% temp_y
for(i in 2:91){
temp_x <- as.matrix(df%>%filter(id == i)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(id == i) %>% select(literacy)
xwx <- xwx + temp_x %*% w %*% temp_x
xwy <- xwy +temp_x %*% w %*% temp_y
}
return((solve(xwx)%*%xwy)[2])
}
calc(df,100)
temp_x <- as.matrix(df%>%filter(id == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
df%>%filter(id == 1)%>%mutate(intercept = 1) %>% select(intercept, followage)
df%>%filter(id == 1)%>%mutate(intercept = 1) %>% select(intercept, followage)
calc <- function(df,sigma_2){
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- temp_x %*% w %*% temp_x
xwy <- temp_x %*% w %*% temp_y
for(i in 2:91){
temp_x <- as.matrix(df%>%filter(subject == i)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == i) %>% select(literacy)
xwx <- xwx + temp_x %*% w %*% temp_x
xwy <- xwy +temp_x %*% w %*% temp_y
}
return((solve(xwx)%*%xwy)[2])
}
calc(df,100)
tempx
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- temp_x %*% w %*% temp_x
xwy <- temp_x %*% w %*% temp_y
temp_x
calc <- function(df,sigma_2){
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- t(temp_x) %*% w %*% t(temp_x)
xwy <- t(temp_x) %*% w %*% temp_y
for(i in 2:91){
temp_x <- as.matrix(df%>%filter(subject == i)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == i) %>% select(literacy)
xwx <- xwx + t(temp_x) %*% w %*% t(temp_x)
xwy <- xwy +t(temp_x) %*% w %*% t(temp_x)
}
return((solve(xwx)%*%xwy)[2])
}
calc(df,100)
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- t(temp_x) %*% w %*% t(temp_x)
xwy <- t(temp_x) %*% w %*% temp_y
temp_x
t(temp_x)
w
t(temp_x)%*%w
t(temp_x)%*%w%*%t(temp_x)
calc <- function(df,sigma_2){
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- t(temp_x) %*% w %*% (temp_x)
xwy <- t(temp_x) %*% w %*% temp_y
for(i in 2:91){
temp_x <- as.matrix(df%>%filter(subject == i)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == i) %>% select(literacy)
xwx <- xwx + t(temp_x) %*% w %*% (temp_x)
xwy <- xwy +t(temp_x) %*% w %*% temp_y
}
return((solve(xwx)%*%xwy)[2])
}
calc(df,100)
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- t(temp_x) %*% w %*% (temp_x)
xwy <- t(temp_x) %*% w %*% temp_y
temp_y
t(temp_x)
w%*% temp_y
temp_y <- as.vector(temp_y)
w%*% temp_y
temp_y
w
as.matrix(temp_y)
w%*%as.matrix(temp_y)
calc <- function(df,sigma_2){
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- t(temp_x) %*% w %*% (temp_x)
xwy <- t(temp_x) %*% w %*% as.matrix(temp_y)
for(i in 2:91){
temp_x <- as.matrix(df%>%filter(subject == i)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == i) %>% select(literacy)
xwx <- xwx + t(temp_x) %*% w %*% (temp_x)
xwy <- xwy +t(temp_x) %*% w %*% as.matrix(temp_y)
}
return((solve(xwx)%*%xwy)[2])
}
calc(df,100)
# Get value of sig_2
var((10-baseage)^2)
# Calculate exact expected value of beta_1 in random model
# Replace y with expectation
df %>% mutate(literacy = (10-baseage)^2+(age-baseage))
calc <- function(df,sigma_2){
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- t(temp_x) %*% w %*% (temp_x)
xwy <- t(temp_x) %*% w %*% as.matrix(temp_y)
for(i in 2:91){
temp_x <- as.matrix(df%>%filter(subject == i)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == i) %>% select(literacy)
xwx <- xwx + t(temp_x) %*% w %*% (temp_x)
xwy <- xwy +t(temp_x) %*% w %*% as.matrix(temp_y)
}
return((solve(xwx)%*%xwy)[2])
}
solve(df,100)
# Calculate exact expected value of beta_1 in random model
# Replace y with expectation
df <- df %>% mutate(literacy = (10-baseage)^2+(age-baseage))
calc <- function(df,sigma_2){
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- t(temp_x) %*% w %*% (temp_x)
xwy <- t(temp_x) %*% w %*% as.matrix(temp_y)
for(i in 2:91){
temp_x <- as.matrix(df%>%filter(subject == i)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == i) %>% select(literacy)
xwx <- xwx + t(temp_x) %*% w %*% (temp_x)
xwy <- xwy +t(temp_x) %*% w %*% as.matrix(temp_y)
}
return((solve(xwx)%*%xwy)[2])
}
solve(df,100)
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- t(temp_x) %*% w %*% (temp_x)
xwy <- t(temp_x) %*% w %*% as.matrix(temp_y)
xwx
xwy
w
# Get value of sig_2
var((10-baseage)^2)
# Calculate exact expected value of beta_1 in random model
# Replace y with expectation
df <- df %>% mutate(literacy = (10-baseage)^2+(age-baseage))
calc <- function(df,sigma_2){
sigm=matrix(rep(599.17/(599.17+sigma_2),9),ncol=3)+diag(1-599.17/(599.17+sigma_2),3)
w <- solve(sigm)
temp_x <- as.matrix(df%>%filter(subject == 1)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == 1) %>% select(literacy)
xwx <- t(temp_x) %*% w %*% (temp_x)
xwy <- t(temp_x) %*% w %*% as.matrix(temp_y)
for(i in 2:91){
temp_x <- as.matrix(df%>%filter(subject == i)%>%mutate(intercept = 1) %>% select(intercept, followage))
temp_y <- df%>%filter(subject == i) %>% select(literacy)
xwx <- xwx + t(temp_x) %*% w %*% (temp_x)
xwy <- xwy +t(temp_x) %*% w %*% as.matrix(temp_y)
}
return((solve(xwx)%*%xwy)[2])
}
calc(df,100)
# Plot vs sig^2
sigs <- c(1:10000,by=10)
est <- rep(0,length(sigs))
for(i in 1:length(sigs)){
est[1] <- calc(df,sigs[i])
}
# Plot vs sig^2
sigs <- c(1:10000,by=100)
est <- rep(0,length(sigs))
for(i in 1:length(sigs)){
est[1] <- calc(df,sigs[i])
}
sigs <- c(0:10000,by=100)
est <- rep(0,length(sigs))
for(i in 1:length(sigs)){
est[1] <- calc(df,sigs[i])
}
plot(sigs,est)
sigs <- c(1:10000,by=100)
est <- rep(0,length(sigs))
for(i in 1:length(sigs)){
est[1] <- calc(df,sigs[i])
}
plot(sigs,est)
t
est
sigs
1:10000:100
1:100:10000
sigs <- c(1:1000)*100
sigs
# Plot vs sig^2
sigs <- c(1:1000)*100
est <- rep(0,length(sigs))
for(i in 1:length(sigs)){
est[i] <- calc(df,sigs[i])
}
plot(sigs,est)
est
# Get value of sig_2
var((10-baseage)^2)
plot(sigs,est-1)
calc(df,100)
plot(loess(1:length(data)~data))
data <-  unlist(read.table("train_results/miscover_50_simple"))
setwd('C:\Users\thaye_000\Dropbox\Noah and Thayer\RNN\testing\sims')
setwd('\Users\thaye_000\Dropbox\Noah and Thayer\RNN\testing\sims')
setwd('/Users/Dropbox/Noah and Thayer/RNN/testing/sims')
setwd('C:/Users/Dropbox/Noah and Thayer/RNN/testing/sims')
theta = c()
var = 0.1
n = 5
for(i in 1:10000){
theta = theta + max(rnorm(5, mean=0, sd= sqrt(var)))
}
theta
theta = c()
var = 0.1
n = 5
for(i in 1:10000){
theta[i] = max(rnorm(5, mean=0, sd= sqrt(var)))
}
theta
mean(theta)
theta = c()
var = 0.1
n = 5
for(i in 1:10000){
theta[i] = max(rnorm(5, mean=0, sd= var))
}
theta
mean(theta)
hist(theta)
library(e1071)
theta = c()
var = 0.1
n = 5
for(i in 1:10000){
theta[i] = max(rnorm(5, mean=0, sd= var))
}
skewness(theta)
install.packages("e1071")
library(e1071)
theta = c()
var = 0.1
n = 5
for(i in 1:10000){
theta[i] = max(rnorm(5, mean=0, sd= var))
}
skewness(theta)
library(e1071)
theta = c()
var = 0.1
n = 5
for(i in 1:100000){
theta[i] = max(rnorm(5, mean=0, sd= var))
}
skewness(theta)
hist(theta)
hist(theta, bins= 100)
hist(theta,breaks=100)
skewness(theta)
n <- 10000
N <- 1000
rm(list=ls())
setwd("C:/Users/thaye_000/Desktop/FHCRC/github/shmr")
loss <- read.csv("sims/loss")
loss <- read.csv("sims/crnn/loss")
loss <- read.csv("sims/crnn/loss")
preds <- read.csv("sims/crnn/preds")
labels <- read.csv("sims/crnn/labels")
preds
dim(preds)
preds <- read.csv("sims/crnn/preds", header = F)
labels <- read.csv("sims/crnn/labels", header = F)
preds
preds = as.numeric(preds[,1])
preds
preds <- read.csv("sims/crnn/preds", header = F)
preds
preds[,1]
preds <- read.csv("sims/crnn/preds", header = F, stringsAsFactors = F)
labels <- read.csv("sims/crnn/labels", header = F, stringsAsFactors = F)
preds[,1]
preds = preds[,1]
preds
preds = lapply(preds,strsplit, arg1 = ",")
preds = lapply(preds,strsplit, split = ",")
preds
preds = as.numeric(preds)
preds
loss <- read.csv("sims/crnn/loss")
preds <- read.csv("sims/crnn/preds", header = F, stringsAsFactors = F)
labels <- read.csv("sims/crnn/labels", header = F, stringsAsFactors = F)
preds = preds[,1]
preds = lapply(preds,strsplit, split = ",")
preds
preds[[500]]
preds[[500]][[1]]
loss <- read.csv("sims/crnn/loss")
preds <- read.csv("sims/crnn/preds", header = F, stringsAsFactors = F)
labels <- read.csv("sims/crnn/labels", header = F, stringsAsFactors = F)
preds = preds[,1]
dim(preds)
length(preds)
preds
preds[1]
preds = lapply(preds,strsplit, split = " ")
preds
preds = as.numeric(preds)
preds
loss <- read.csv("sims/crnn/loss")
preds <- read.csv("sims/crnn/preds", header = F, stringsAsFactors = F)
labels <- read.csv("sims/crnn/labels", header = F, stringsAsFactors = F)
preds = preds[,1]
preds = lapply(preds,strsplit, split = " ")
as.numeric(preds[[1]])
preds[[1]]
preds[[1]][[1]]
as.numeric(preds[[1]][[1]])
preds[1,]
preds2 = matrix(0L,nrow = 500, ncol = 9)
loss <- read.csv("sims/crnn/loss")
preds <- read.csv("sims/crnn/preds", header = F, stringsAsFactors = F)
labels <- read.csv("sims/crnn/labels", header = F, stringsAsFactors = F)
preds = preds[,1]
preds = lapply(preds,strsplit, split = " ")
preds2 = matrix(0L,nrow = 500, ncol = 9)
for( i in 1:500){
preds2[i,] = as.numeric(preds[[i]][[1]])
}
preds2
preds2[1,]
preds2[111,]
labels
dim(labels)
dim(preds)
dim(preds2)
install.packages("resample")
library(resample)
colVars(labels-preds2)/colVars(labels)
colVars(labels-preds2)
loss <- read.csv("sims/crnn/loss")
preds <- read.csv("sims/crnn/preds", header = F, stringsAsFactors = F)
labels <- read.csv("sims/crnn/labels", header = F, stringsAsFactors = F)
preds = preds[,1]
preds = lapply(preds,strsplit, split = " ")
preds2 = matrix(0L,nrow = 500, ncol = 9)
for( i in 1:500){
preds2[i,] = as.numeric(preds[[i]][[1]])
}
library(resample)
colVars(labels-preds2)
colVars(labels-preds2)/colVars(labels)
plot(labels[,1],preds2[,1])
